{"ast":null,"code":"var _jsxFileName = \"/Users/dp/Desktop/b_securon/frontend/src/components/IaCScanner.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useCallback } from 'react';\nimport { Box, Button, Typography, Card, CardContent, TextField, Alert, List, ListItem, ListItemText, Chip, Tabs, Tab, Grid, LinearProgress } from '@mui/material';\nimport { CloudUpload, Code, Security, Warning, Info, CheckCircle, BugReport } from '@mui/icons-material';\nimport { useDropzone } from 'react-dropzone';\nimport apiClient from '../config/api';\nimport { Severity } from '../types';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst IaCScanner = () => {\n  _s();\n  const [tabValue, setTabValue] = useState(0);\n  const [terraformCode, setTerraformCode] = useState('');\n  const [scanning, setScanning] = useState(false);\n  const [scanResult, setScanResult] = useState(null);\n  const [error, setError] = useState(null);\n  const [expandedResults, setExpandedResults] = useState(new Set());\n  const onDrop = useCallback(async acceptedFiles => {\n    if (acceptedFiles.length === 0) return;\n    setScanning(true);\n    setError(null);\n    setScanResult(null);\n    try {\n      const formData = new FormData();\n      acceptedFiles.forEach(file => {\n        formData.append('files', file);\n      });\n      const response = await apiClient.post('/api/iac/scan', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      });\n      setScanResult(response.data);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail) || 'Failed to scan files');\n    } finally {\n      setScanning(false);\n    }\n  }, []);\n  const handleTextScan = async () => {\n    if (!terraformCode.trim()) {\n      setError('Please enter Terraform code to scan');\n      return;\n    }\n    setScanning(true);\n    setError(null);\n    setScanResult(null);\n    try {\n      const formData = new FormData();\n      formData.append('terraform_code', terraformCode);\n      const response = await apiClient.post('/api/iac/scan-text', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      });\n      setScanResult(response.data);\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      setError(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.detail) || 'Failed to scan code');\n    } finally {\n      setScanning(false);\n    }\n  };\n  const {\n    getRootProps,\n    getInputProps,\n    isDragActive\n  } = useDropzone({\n    onDrop,\n    accept: {\n      'text/plain': ['.tf', '.hcl'],\n      'application/octet-stream': ['.tf', '.hcl']\n    },\n    multiple: true\n  });\n  const getSeverityIcon = severity => {\n    switch (severity) {\n      case Severity.CRITICAL:\n        return /*#__PURE__*/_jsxDEV(BugReport, {\n          sx: {\n            color: '#d32f2f'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 16\n        }, this);\n      case Severity.HIGH:\n        return /*#__PURE__*/_jsxDEV(Warning, {\n          sx: {\n            color: '#f57c00'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 16\n        }, this);\n      case Severity.MEDIUM:\n        return /*#__PURE__*/_jsxDEV(Info, {\n          sx: {\n            color: '#1976d2'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 16\n        }, this);\n      case Severity.LOW:\n        return /*#__PURE__*/_jsxDEV(Info, {\n          sx: {\n            color: '#616161'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 16\n        }, this);\n      default:\n        return /*#__PURE__*/_jsxDEV(Info, {\n          sx: {\n            color: '#616161'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 16\n        }, this);\n    }\n  };\n  const getSeverityColor = severity => {\n    switch (severity) {\n      case Severity.CRITICAL:\n        return '#d32f2f';\n      case Severity.HIGH:\n        return '#f57c00';\n      case Severity.MEDIUM:\n        return '#1976d2';\n      case Severity.LOW:\n        return '#616161';\n      default:\n        return '#616161';\n    }\n  };\n  const getSeverityBackground = severity => {\n    switch (severity) {\n      case Severity.CRITICAL:\n        return '#ffebee';\n      case Severity.HIGH:\n        return '#fff3e0';\n      case Severity.MEDIUM:\n        return '#e3f2fd';\n      case Severity.LOW:\n        return '#f5f5f5';\n      default:\n        return '#f5f5f5';\n    }\n  };\n  const groupResultsBySeverity = results => {\n    const grouped = results.reduce((acc, result) => {\n      if (!acc[result.severity]) {\n        acc[result.severity] = [];\n      }\n      acc[result.severity].push(result);\n      return acc;\n    }, {});\n\n    // Sort by severity priority\n    const severityOrder = [Severity.CRITICAL, Severity.HIGH, Severity.MEDIUM, Severity.LOW];\n    return severityOrder.reduce((acc, severity) => {\n      if (grouped[severity]) {\n        acc[severity] = grouped[severity];\n      }\n      return acc;\n    }, {});\n  };\n  const getSecurityInsights = results => {\n    const insights = [];\n    const grouped = groupResultsBySeverity(results);\n    Object.entries(grouped).forEach(([severity, severityResults]) => {\n      const categories = severityResults.reduce((acc, result) => {\n        const category = result.rule_id.split('-')[0].toUpperCase();\n        acc[category] = (acc[category] || 0) + 1;\n        return acc;\n      }, {});\n      Object.entries(categories).forEach(([category, count]) => {\n        insights.push({\n          category,\n          count,\n          severity: severity,\n          description: getCategoryDescription(category)\n        });\n      });\n    });\n    return insights.sort((a, b) => {\n      const severityWeight = {\n        CRITICAL: 4,\n        HIGH: 3,\n        MEDIUM: 2,\n        LOW: 1\n      };\n      return (severityWeight[b.severity] || 0) - (severityWeight[a.severity] || 0);\n    });\n  };\n  const getCategoryDescription = category => {\n    const descriptions = {\n      'S3': 'Amazon S3 storage security configurations',\n      'SG': 'Security Group network access controls',\n      'EC2': 'Elastic Compute Cloud instance security',\n      'RDS': 'Relational Database Service security',\n      'IAM': 'Identity and Access Management policies',\n      'VPC': 'Virtual Private Cloud network security',\n      'KMS': 'Key Management Service encryption',\n      'LAMBDA': 'AWS Lambda function security',\n      'CLOUDTRAIL': 'CloudTrail logging and monitoring'\n    };\n    return descriptions[category] || `${category} security configurations`;\n  };\n  const toggleResultExpansion = index => {\n    const newExpanded = new Set(expandedResults);\n    if (newExpanded.has(index)) {\n      newExpanded.delete(index);\n    } else {\n      newExpanded.add(index);\n    }\n    setExpandedResults(newExpanded);\n  };\n  return /*#__PURE__*/_jsxDEV(Box, {\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h5\",\n      gutterBottom: true,\n      children: \"Infrastructure as Code Scanner\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Card, {\n      sx: {\n        mb: 3\n      },\n      children: /*#__PURE__*/_jsxDEV(CardContent, {\n        children: [/*#__PURE__*/_jsxDEV(Tabs, {\n          value: tabValue,\n          onChange: (_, newValue) => setTabValue(newValue),\n          children: [/*#__PURE__*/_jsxDEV(Tab, {\n            icon: /*#__PURE__*/_jsxDEV(CloudUpload, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 24\n            }, this),\n            label: \"Upload Files\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Tab, {\n            icon: /*#__PURE__*/_jsxDEV(Code, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 24\n            }, this),\n            label: \"Paste Code\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            mt: 2\n          },\n          children: [tabValue === 0 && /*#__PURE__*/_jsxDEV(Box, {\n            ...getRootProps(),\n            sx: {\n              border: '2px dashed',\n              borderColor: isDragActive ? 'primary.main' : 'grey.300',\n              borderRadius: 2,\n              p: 4,\n              textAlign: 'center',\n              cursor: 'pointer',\n              bgcolor: isDragActive ? 'action.hover' : 'background.paper',\n              '&:hover': {\n                bgcolor: 'action.hover'\n              }\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              ...getInputProps()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 284,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(CloudUpload, {\n              sx: {\n                fontSize: 48,\n                color: 'grey.500',\n                mb: 2\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"h6\",\n              gutterBottom: true,\n              children: isDragActive ? 'Drop the files here' : 'Drag & drop Terraform files here'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 286,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body2\",\n              color: \"text.secondary\",\n              gutterBottom: true,\n              children: \"or click to select files\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 289,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"caption\",\n              color: \"text.secondary\",\n              children: \"Supported formats: .tf, .hcl\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 292,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 15\n          }, this), tabValue === 1 && /*#__PURE__*/_jsxDEV(Box, {\n            children: [/*#__PURE__*/_jsxDEV(TextField, {\n              fullWidth: true,\n              multiline: true,\n              rows: 12,\n              variant: \"outlined\",\n              placeholder: \"Paste your Terraform code here...\",\n              value: terraformCode,\n              onChange: e => setTerraformCode(e.target.value),\n              sx: {\n                mb: 2,\n                '& .MuiInputBase-input': {\n                  fontFamily: 'monospace',\n                  fontSize: '0.875rem'\n                }\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 300,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"contained\",\n              startIcon: /*#__PURE__*/_jsxDEV(Security, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 318,\n                columnNumber: 30\n              }, this),\n              onClick: handleTextScan,\n              disabled: scanning || !terraformCode.trim(),\n              children: \"Scan Code\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 7\n    }, this), scanning && /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        mb: 3\n      },\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body2\",\n        gutterBottom: true,\n        children: \"Scanning for security misconfigurations...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(LinearProgress, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 9\n    }, this), error && /*#__PURE__*/_jsxDEV(Alert, {\n      severity: \"error\",\n      sx: {\n        mb: 3\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 9\n    }, this), scanResult && /*#__PURE__*/_jsxDEV(Card, {\n      children: /*#__PURE__*/_jsxDEV(CardContent, {\n        children: [/*#__PURE__*/_jsxDEV(Box, {\n          display: \"flex\",\n          alignItems: \"center\",\n          gap: 1,\n          mb: 2,\n          children: [scanResult.issues_found === 0 ? /*#__PURE__*/_jsxDEV(CheckCircle, {\n            color: \"success\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(Warning, {\n            color: \"warning\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 352,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h6\",\n            children: \"Scan Results\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          container: true,\n          spacing: 2,\n          sx: {\n            mb: 3\n          },\n          children: [scanResult.files_scanned && /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 12,\n            sm: 4,\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"h6\",\n              color: \"primary\",\n              children: scanResult.files_scanned\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 362,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body2\",\n              color: \"text.secondary\",\n              children: \"Files Scanned\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 365,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            xs: 12,\n            sm: 4,\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"h6\",\n              color: scanResult.issues_found > 0 ? \"warning.main\" : \"success.main\",\n              children: scanResult.issues_found\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 371,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body2\",\n              color: \"text.secondary\",\n              children: \"Issues Found\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 374,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 370,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 13\n        }, this), scanResult.issues_found === 0 ? /*#__PURE__*/_jsxDEV(Alert, {\n          severity: \"success\",\n          children: \"No security issues found! Your Terraform code looks good.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(Box, {\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h6\",\n            gutterBottom: true,\n            children: \"Security Issues\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 386,\n            columnNumber: 17\n          }, this), Object.entries(groupResultsBySeverity(scanResult.results)).map(([severity, results]) => /*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              mb: 2\n            },\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"subtitle1\",\n              gutterBottom: true,\n              children: /*#__PURE__*/_jsxDEV(Chip, {\n                label: `${severity} (${results.length})`,\n                color: getSeverityColor(severity),\n                size: \"small\",\n                sx: {\n                  mr: 1\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 393,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(List, {\n              dense: true,\n              children: results.map((result, index) => /*#__PURE__*/_jsxDEV(ListItem, {\n                divider: true,\n                children: /*#__PURE__*/_jsxDEV(ListItemText, {\n                  primary: /*#__PURE__*/_jsxDEV(Box, {\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    gap: 1,\n                    children: [getSeverityIcon(result.severity), /*#__PURE__*/_jsxDEV(Typography, {\n                      variant: \"subtitle2\",\n                      children: result.description\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 408,\n                      columnNumber: 33\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 406,\n                    columnNumber: 31\n                  }, this),\n                  secondary: /*#__PURE__*/_jsxDEV(Box, {\n                    children: [/*#__PURE__*/_jsxDEV(Typography, {\n                      variant: \"body2\",\n                      color: \"text.secondary\",\n                      children: [\"File: \", result.file_path, \" (Line \", result.line_number, \")\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 415,\n                      columnNumber: 33\n                    }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                      variant: \"body2\",\n                      color: \"text.secondary\",\n                      children: [\"Rule: \", result.rule_id]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 418,\n                      columnNumber: 33\n                    }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                      variant: \"body2\",\n                      color: \"success.main\",\n                      sx: {\n                        mt: 1\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                        children: \"Remediation:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 422,\n                        columnNumber: 35\n                      }, this), \" \", result.remediation]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 421,\n                      columnNumber: 33\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 414,\n                    columnNumber: 31\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 404,\n                  columnNumber: 27\n                }, this)\n              }, index, false, {\n                fileName: _jsxFileName,\n                lineNumber: 403,\n                columnNumber: 25\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 21\n            }, this)]\n          }, severity, true, {\n            fileName: _jsxFileName,\n            lineNumber: 391,\n            columnNumber: 19\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 255,\n    columnNumber: 5\n  }, this);\n};\n_s(IaCScanner, \"CR/71j2+RgiBv4vHhARyTJd+rfk=\", false, function () {\n  return [useDropzone];\n});\n_c = IaCScanner;\nexport default IaCScanner;\nvar _c;\n$RefreshReg$(_c, \"IaCScanner\");","map":{"version":3,"names":["React","useState","useCallback","Box","Button","Typography","Card","CardContent","TextField","Alert","List","ListItem","ListItemText","Chip","Tabs","Tab","Grid","LinearProgress","CloudUpload","Code","Security","Warning","Info","CheckCircle","BugReport","useDropzone","apiClient","Severity","jsxDEV","_jsxDEV","IaCScanner","_s","tabValue","setTabValue","terraformCode","setTerraformCode","scanning","setScanning","scanResult","setScanResult","error","setError","expandedResults","setExpandedResults","Set","onDrop","acceptedFiles","length","formData","FormData","forEach","file","append","response","post","headers","data","err","_err$response","_err$response$data","detail","handleTextScan","trim","_err$response2","_err$response2$data","getRootProps","getInputProps","isDragActive","accept","multiple","getSeverityIcon","severity","CRITICAL","sx","color","fileName","_jsxFileName","lineNumber","columnNumber","HIGH","MEDIUM","LOW","getSeverityColor","getSeverityBackground","groupResultsBySeverity","results","grouped","reduce","acc","result","push","severityOrder","getSecurityInsights","insights","Object","entries","severityResults","categories","category","rule_id","split","toUpperCase","count","description","getCategoryDescription","sort","a","b","severityWeight","descriptions","toggleResultExpansion","index","newExpanded","has","delete","add","children","variant","gutterBottom","mb","value","onChange","_","newValue","icon","label","mt","border","borderColor","borderRadius","p","textAlign","cursor","bgcolor","fontSize","fullWidth","multiline","rows","placeholder","e","target","fontFamily","startIcon","onClick","disabled","display","alignItems","gap","issues_found","container","spacing","files_scanned","item","xs","sm","map","size","mr","dense","divider","primary","secondary","file_path","line_number","remediation","_c","$RefreshReg$"],"sources":["/Users/dp/Desktop/b_securon/frontend/src/components/IaCScanner.tsx"],"sourcesContent":["import React, { useState, useCallback } from 'react';\nimport {\n  Box,\n  Button,\n  Typography,\n  Card,\n  CardContent,\n  TextField,\n  Alert,\n  List,\n  ListItem,\n  ListItemText,\n  Chip,\n  Tabs,\n  Tab,\n  Grid,\n  LinearProgress,\n  Accordion,\n  AccordionSummary,\n  AccordionDetails,\n  Divider,\n  Paper,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  Tooltip,\n  IconButton,\n  Collapse\n} from '@mui/material';\nimport {\n  CloudUpload,\n  Code,\n  Security,\n  Warning,\n  Info,\n  CheckCircle,\n  ExpandMore,\n  BugReport,\n  Shield,\n  Assessment,\n  FileCopy,\n  ExpandLess,\n  ExpandMore as ExpandMoreIcon\n} from '@mui/icons-material';\nimport { useDropzone } from 'react-dropzone';\nimport apiClient from '../config/api';\nimport { ScanResult, Severity } from '../types';\n\ninterface ScanResponse {\n  message: string;\n  files_scanned?: number;\n  issues_found: number;\n  results: ScanResult[];\n}\n\ninterface SecurityInsight {\n  category: string;\n  count: number;\n  severity: Severity;\n  description: string;\n}\n\nconst IaCScanner: React.FC = () => {\n  const [tabValue, setTabValue] = useState(0);\n  const [terraformCode, setTerraformCode] = useState('');\n  const [scanning, setScanning] = useState(false);\n  const [scanResult, setScanResult] = useState<ScanResponse | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [expandedResults, setExpandedResults] = useState<Set<number>>(new Set());\n\n  const onDrop = useCallback(async (acceptedFiles: File[]) => {\n    if (acceptedFiles.length === 0) return;\n\n    setScanning(true);\n    setError(null);\n    setScanResult(null);\n\n    try {\n      const formData = new FormData();\n      acceptedFiles.forEach(file => {\n        formData.append('files', file);\n      });\n\n      const response = await apiClient.post('/api/iac/scan', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n        },\n      });\n\n      setScanResult(response.data);\n    } catch (err: any) {\n      setError(err.response?.data?.detail || 'Failed to scan files');\n    } finally {\n      setScanning(false);\n    }\n  }, []);\n\n  const handleTextScan = async () => {\n    if (!terraformCode.trim()) {\n      setError('Please enter Terraform code to scan');\n      return;\n    }\n\n    setScanning(true);\n    setError(null);\n    setScanResult(null);\n\n    try {\n      const formData = new FormData();\n      formData.append('terraform_code', terraformCode);\n\n      const response = await apiClient.post('/api/iac/scan-text', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n        },\n      });\n\n      setScanResult(response.data);\n    } catch (err: any) {\n      setError(err.response?.data?.detail || 'Failed to scan code');\n    } finally {\n      setScanning(false);\n    }\n  };\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    accept: {\n      'text/plain': ['.tf', '.hcl'],\n      'application/octet-stream': ['.tf', '.hcl']\n    },\n    multiple: true\n  });\n\n  const getSeverityIcon = (severity: Severity) => {\n    switch (severity) {\n      case Severity.CRITICAL:\n        return <BugReport sx={{ color: '#d32f2f' }} />;\n      case Severity.HIGH:\n        return <Warning sx={{ color: '#f57c00' }} />;\n      case Severity.MEDIUM:\n        return <Info sx={{ color: '#1976d2' }} />;\n      case Severity.LOW:\n        return <Info sx={{ color: '#616161' }} />;\n      default:\n        return <Info sx={{ color: '#616161' }} />;\n    }\n  };\n\n  const getSeverityColor = (severity: Severity): string => {\n    switch (severity) {\n      case Severity.CRITICAL:\n        return '#d32f2f';\n      case Severity.HIGH:\n        return '#f57c00';\n      case Severity.MEDIUM:\n        return '#1976d2';\n      case Severity.LOW:\n        return '#616161';\n      default:\n        return '#616161';\n    }\n  };\n\n  const getSeverityBackground = (severity: Severity): string => {\n    switch (severity) {\n      case Severity.CRITICAL:\n        return '#ffebee';\n      case Severity.HIGH:\n        return '#fff3e0';\n      case Severity.MEDIUM:\n        return '#e3f2fd';\n      case Severity.LOW:\n        return '#f5f5f5';\n      default:\n        return '#f5f5f5';\n    }\n  };\n\n  const groupResultsBySeverity = (results: ScanResult[]) => {\n    const grouped = results.reduce((acc, result) => {\n      if (!acc[result.severity]) {\n        acc[result.severity] = [];\n      }\n      acc[result.severity].push(result);\n      return acc;\n    }, {} as Record<Severity, ScanResult[]>);\n\n    // Sort by severity priority\n    const severityOrder = [Severity.CRITICAL, Severity.HIGH, Severity.MEDIUM, Severity.LOW];\n    return severityOrder.reduce((acc, severity) => {\n      if (grouped[severity]) {\n        acc[severity] = grouped[severity];\n      }\n      return acc;\n    }, {} as Record<Severity, ScanResult[]>);\n  };\n\n  const getSecurityInsights = (results: ScanResult[]): SecurityInsight[] => {\n    const insights: SecurityInsight[] = [];\n    const grouped = groupResultsBySeverity(results);\n    \n    Object.entries(grouped).forEach(([severity, severityResults]) => {\n      const categories = severityResults.reduce((acc, result) => {\n        const category = result.rule_id.split('-')[0].toUpperCase();\n        acc[category] = (acc[category] || 0) + 1;\n        return acc;\n      }, {} as Record<string, number>);\n\n      Object.entries(categories).forEach(([category, count]) => {\n        insights.push({\n          category,\n          count,\n          severity: severity as Severity,\n          description: getCategoryDescription(category)\n        });\n      });\n    });\n\n    return insights.sort((a, b) => {\n      const severityWeight = { CRITICAL: 4, HIGH: 3, MEDIUM: 2, LOW: 1 };\n      return (severityWeight[b.severity] || 0) - (severityWeight[a.severity] || 0);\n    });\n  };\n\n  const getCategoryDescription = (category: string): string => {\n    const descriptions: Record<string, string> = {\n      'S3': 'Amazon S3 storage security configurations',\n      'SG': 'Security Group network access controls',\n      'EC2': 'Elastic Compute Cloud instance security',\n      'RDS': 'Relational Database Service security',\n      'IAM': 'Identity and Access Management policies',\n      'VPC': 'Virtual Private Cloud network security',\n      'KMS': 'Key Management Service encryption',\n      'LAMBDA': 'AWS Lambda function security',\n      'CLOUDTRAIL': 'CloudTrail logging and monitoring'\n    };\n    return descriptions[category] || `${category} security configurations`;\n  };\n\n  const toggleResultExpansion = (index: number) => {\n    const newExpanded = new Set(expandedResults);\n    if (newExpanded.has(index)) {\n      newExpanded.delete(index);\n    } else {\n      newExpanded.add(index);\n    }\n    setExpandedResults(newExpanded);\n  };\n\n  return (\n    <Box>\n      <Typography variant=\"h5\" gutterBottom>\n        Infrastructure as Code Scanner\n      </Typography>\n\n      <Card sx={{ mb: 3 }}>\n        <CardContent>\n          <Tabs value={tabValue} onChange={(_, newValue) => setTabValue(newValue)}>\n            <Tab icon={<CloudUpload />} label=\"Upload Files\" />\n            <Tab icon={<Code />} label=\"Paste Code\" />\n          </Tabs>\n\n          <Box sx={{ mt: 2 }}>\n            {tabValue === 0 && (\n              <Box\n                {...getRootProps()}\n                sx={{\n                  border: '2px dashed',\n                  borderColor: isDragActive ? 'primary.main' : 'grey.300',\n                  borderRadius: 2,\n                  p: 4,\n                  textAlign: 'center',\n                  cursor: 'pointer',\n                  bgcolor: isDragActive ? 'action.hover' : 'background.paper',\n                  '&:hover': {\n                    bgcolor: 'action.hover',\n                  },\n                }}\n              >\n                <input {...getInputProps()} />\n                <CloudUpload sx={{ fontSize: 48, color: 'grey.500', mb: 2 }} />\n                <Typography variant=\"h6\" gutterBottom>\n                  {isDragActive ? 'Drop the files here' : 'Drag & drop Terraform files here'}\n                </Typography>\n                <Typography variant=\"body2\" color=\"text.secondary\" gutterBottom>\n                  or click to select files\n                </Typography>\n                <Typography variant=\"caption\" color=\"text.secondary\">\n                  Supported formats: .tf, .hcl\n                </Typography>\n              </Box>\n            )}\n\n            {tabValue === 1 && (\n              <Box>\n                <TextField\n                  fullWidth\n                  multiline\n                  rows={12}\n                  variant=\"outlined\"\n                  placeholder=\"Paste your Terraform code here...\"\n                  value={terraformCode}\n                  onChange={(e) => setTerraformCode(e.target.value)}\n                  sx={{\n                    mb: 2,\n                    '& .MuiInputBase-input': {\n                      fontFamily: 'monospace',\n                      fontSize: '0.875rem',\n                    },\n                  }}\n                />\n                <Button\n                  variant=\"contained\"\n                  startIcon={<Security />}\n                  onClick={handleTextScan}\n                  disabled={scanning || !terraformCode.trim()}\n                >\n                  Scan Code\n                </Button>\n              </Box>\n            )}\n          </Box>\n        </CardContent>\n      </Card>\n\n      {scanning && (\n        <Box sx={{ mb: 3 }}>\n          <Typography variant=\"body2\" gutterBottom>\n            Scanning for security misconfigurations...\n          </Typography>\n          <LinearProgress />\n        </Box>\n      )}\n\n      {error && (\n        <Alert severity=\"error\" sx={{ mb: 3 }}>\n          {error}\n        </Alert>\n      )}\n\n      {scanResult && (\n        <Card>\n          <CardContent>\n            <Box display=\"flex\" alignItems=\"center\" gap={1} mb={2}>\n              {scanResult.issues_found === 0 ? (\n                <CheckCircle color=\"success\" />\n              ) : (\n                <Warning color=\"warning\" />\n              )}\n              <Typography variant=\"h6\">\n                Scan Results\n              </Typography>\n            </Box>\n\n            <Grid container spacing={2} sx={{ mb: 3 }}>\n              {scanResult.files_scanned && (\n                <Grid item xs={12} sm={4}>\n                  <Typography variant=\"h6\" color=\"primary\">\n                    {scanResult.files_scanned}\n                  </Typography>\n                  <Typography variant=\"body2\" color=\"text.secondary\">\n                    Files Scanned\n                  </Typography>\n                </Grid>\n              )}\n              <Grid item xs={12} sm={4}>\n                <Typography variant=\"h6\" color={scanResult.issues_found > 0 ? \"warning.main\" : \"success.main\"}>\n                  {scanResult.issues_found}\n                </Typography>\n                <Typography variant=\"body2\" color=\"text.secondary\">\n                  Issues Found\n                </Typography>\n              </Grid>\n            </Grid>\n\n            {scanResult.issues_found === 0 ? (\n              <Alert severity=\"success\">\n                No security issues found! Your Terraform code looks good.\n              </Alert>\n            ) : (\n              <Box>\n                <Typography variant=\"h6\" gutterBottom>\n                  Security Issues\n                </Typography>\n                \n                {Object.entries(groupResultsBySeverity(scanResult.results)).map(([severity, results]) => (\n                  <Box key={severity} sx={{ mb: 2 }}>\n                    <Typography variant=\"subtitle1\" gutterBottom>\n                      <Chip\n                        label={`${severity} (${results.length})`}\n                        color={getSeverityColor(severity as Severity)}\n                        size=\"small\"\n                        sx={{ mr: 1 }}\n                      />\n                    </Typography>\n                    \n                    <List dense>\n                      {results.map((result, index) => (\n                        <ListItem key={index} divider>\n                          <ListItemText\n                            primary={\n                              <Box display=\"flex\" alignItems=\"center\" gap={1}>\n                                {getSeverityIcon(result.severity)}\n                                <Typography variant=\"subtitle2\">\n                                  {result.description}\n                                </Typography>\n                              </Box>\n                            }\n                            secondary={\n                              <Box>\n                                <Typography variant=\"body2\" color=\"text.secondary\">\n                                  File: {result.file_path} (Line {result.line_number})\n                                </Typography>\n                                <Typography variant=\"body2\" color=\"text.secondary\">\n                                  Rule: {result.rule_id}\n                                </Typography>\n                                <Typography variant=\"body2\" color=\"success.main\" sx={{ mt: 1 }}>\n                                  <strong>Remediation:</strong> {result.remediation}\n                                </Typography>\n                              </Box>\n                            }\n                          />\n                        </ListItem>\n                      ))}\n                    </List>\n                  </Box>\n                ))}\n              </Box>\n            )}\n          </CardContent>\n        </Card>\n      )}\n    </Box>\n  );\n};\n\nexport default IaCScanner;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}